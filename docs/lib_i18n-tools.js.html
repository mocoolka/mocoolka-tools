<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>lib/i18n-tools.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="I18n.html">I18n</a><ul class='methods'><li data-type='method'><a href="I18n.html#.newInstance">newInstance</a></li></ul></li><li><a href="Message.html">Message</a></li><li><a href="Text.html">Text</a></li></ul><h3>Modules</h3><ul><li><a href="module-mocoolka-tools.html">mocoolka-tools</a></li><li><a href="module-mocoolka-tools-array.html">mocoolka-tools-array</a><ul class='methods'><li data-type='method'><a href="module-mocoolka-tools-array.html#~getArrayFromArrayByOrder">getArrayFromArrayByOrder</a></li></ul></li><li><a href="module-mocoolka-tools-cldr.html">mocoolka-tools-cldr</a><ul class='methods'><li data-type='method'><a href="module-mocoolka-tools-cldr.html#~getSupportedLanguage">getSupportedLanguage</a></li><li data-type='method'><a href="module-mocoolka-tools-cldr.html#~getSupportedLanguages">getSupportedLanguages</a></li><li data-type='method'><a href="module-mocoolka-tools-cldr.html#~isSupportedLanguage">isSupportedLanguage</a></li></ul></li><li><a href="module-mocoolka-tools-config.html">mocoolka-tools-config</a><ul class='methods'><li data-type='method'><a href="module-mocoolka-tools-config.html#~getAppConfig">getAppConfig</a></li><li data-type='method'><a href="module-mocoolka-tools-config.html#~getConfig">getConfig</a></li><li data-type='method'><a href="module-mocoolka-tools-config.html#~setConfig">setConfig</a></li></ul></li><li><a href="module-mocoolka-tools-env.html">mocoolka-tools-env</a><ul class='methods'><li data-type='method'><a href="module-mocoolka-tools-env.html#~appLanguage">appLanguage</a></li></ul></li><li><a href="module-mocoolka-tools-error.html">mocoolka-tools-error</a><ul class='methods'><li data-type='method'><a href="module-mocoolka-tools-error.html#~paramRequired">paramRequired</a></li></ul></li><li><a href="module-mocoolka-tools-file.html">mocoolka-tools-file</a><ul class='methods'><li data-type='method'><a href="module-mocoolka-tools-file.html#~createDirNotExist">createDirNotExist</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~deleteDirExist">deleteDirExist</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~directoryDepth">directoryDepth</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~directoryExist">directoryExist</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~fileExist">fileExist</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~getConfigValue">getConfigValue</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~getCurrentDir">getCurrentDir</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~getFileExtName">getFileExtName</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~getMKFileExtName">getMKFileExtName</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~getRootDirectory">getRootDirectory</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~getToolsModuleDirectory">getToolsModuleDirectory</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~IsExceedMaxDirectoryDepth">IsExceedMaxDirectoryDepth</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~isFullPath">isFullPath</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~maxDirectoryDepth">maxDirectoryDepth</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~openFile">openFile</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~openFileAsPlainString">openFileAsPlainString</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~path">path</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~pathArray">pathArray</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~realPath">realPath</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~stripBom">stripBom</a></li><li data-type='method'><a href="module-mocoolka-tools-file.html#~unsymbolLink">unsymbolLink</a></li></ul></li><li><a href="module-mocoolka-tools-file-js.html">mocoolka-tools-file-js</a><ul class='methods'><li data-type='method'><a href="module-mocoolka-tools-file-js.html#~open">open</a></li></ul></li><li><a href="module-mocoolka-tools-file-json.html">mocoolka-tools-file-json</a><ul class='methods'><li data-type='method'><a href="module-mocoolka-tools-file-json.html#~open">open</a></li></ul></li><li><a href="module-mocoolka-tools-file-yml.html">mocoolka-tools-file-yml</a><ul class='methods'><li data-type='method'><a href="module-mocoolka-tools-file-yml.html#~open">open</a></li></ul></li><li><a href="module-mocoolka-tools-format.html">mocoolka-tools-format</a><ul class='methods'><li data-type='method'><a href="module-mocoolka-tools-format.html#~mapArgs">mapArgs</a></li><li data-type='method'><a href="module-mocoolka-tools-format.html#~mapPercent">mapPercent</a></li><li data-type='method'><a href="module-mocoolka-tools-format.html#~retrievePercentSymbol">retrievePercentSymbol</a></li></ul></li><li><a href="module-mocoolka-tools-global.html">mocoolka-tools-global</a><ul class='methods'><li data-type='method'><a href="module-mocoolka-tools-global.html#~getGlobal">getGlobal</a></li><li data-type='method'><a href="module-mocoolka-tools-global.html#~setGlobalItem">setGlobalItem</a></li></ul></li><li><a href="module-mocoolka-tools-i18n.html">mocoolka-tools-i18n</a><ul class='methods'><li data-type='method'><a href="module-mocoolka-tools-i18n.html#~consoleEnabled">consoleEnabled</a></li><li data-type='method'><a href="module-mocoolka-tools-i18n.html#~enumerateMsgSync">enumerateMsgSync</a></li><li data-type='method'><a href="module-mocoolka-tools-i18n.html#~formatCurrency">formatCurrency</a></li><li data-type='method'><a href="module-mocoolka-tools-i18n.html#~formatDate">formatDate</a></li><li data-type='method'><a href="module-mocoolka-tools-i18n.html#~formatNumber">formatNumber</a></li><li data-type='method'><a href="module-mocoolka-tools-i18n.html#~getGI18N">getGI18N</a></li><li data-type='method'><a href="module-mocoolka-tools-i18n.html#~getModuleDirectory">getModuleDirectory</a></li><li data-type='method'><a href="module-mocoolka-tools-i18n.html#~initI18N">initI18N</a></li><li data-type='method'><a href="module-mocoolka-tools-i18n.html#~loadCldr">loadCldr</a></li><li data-type='method'><a href="module-mocoolka-tools-i18n.html#~loadMessageFromFile">loadMessageFromFile</a></li><li data-type='method'><a href="module-mocoolka-tools-i18n.html#~logPersistent">logPersistent</a></li></ul></li><li><a href="module-mocoolka-tools-module.html">mocoolka-tools-module</a><ul class='methods'><li data-type='method'><a href="module-mocoolka-tools-module.html#~enumerateFilesSync">enumerateFilesSync</a></li><li data-type='method'><a href="module-mocoolka-tools-module.html#~enumerateFilesSyncPriv">enumerateFilesSyncPriv</a></li><li data-type='method'><a href="module-mocoolka-tools-module.html#~fileSyncScanned">fileSyncScanned</a></li><li data-type='method'><a href="module-mocoolka-tools-module.html#~getModuleItem">getModuleItem</a></li><li data-type='method'><a href="module-mocoolka-tools-module.html#~getModuleName">getModuleName</a></li><li data-type='method'><a href="module-mocoolka-tools-module.html#~getModuleVersion">getModuleVersion</a></li><li data-type='method'><a href="module-mocoolka-tools-module.html#~isRootModule">isRootModule</a></li><li data-type='method'><a href="module-mocoolka-tools-module.html#~moduleFileResolve">moduleFileResolve</a></li><li data-type='method'><a href="module-mocoolka-tools-module.html#~resolveDependencies">resolveDependencies</a></li></ul></li><li><a href="module-mocoolka-tools-object.html">mocoolka-tools-object</a><ul class='methods'><li data-type='method'><a href="module-mocoolka-tools-object.html#~clone">clone</a></li><li data-type='method'><a href="module-mocoolka-tools-object.html#~merge">merge</a></li><li data-type='method'><a href="module-mocoolka-tools-object.html#~mergeAll">mergeAll</a></li><li data-type='method'><a href="module-mocoolka-tools-object.html#~mergeBase">mergeBase</a></li><li data-type='method'><a href="module-mocoolka-tools-object.html#~mergeRecursiveBasic">mergeRecursiveBasic</a></li><li data-type='method'><a href="module-mocoolka-tools-object.html#~typeOf">typeOf</a></li></ul></li><li><a href="module-mocoolka-tools-os.html">mocoolka-tools-os</a><ul class='methods'><li data-type='method'><a href="module-mocoolka-tools-os.html#~getOSLanguage">getOSLanguage</a></li><li data-type='method'><a href="module-mocoolka-tools-os.html#~getPlatform">getPlatform</a></li></ul></li><li><a href="module-mocoolka-tools-string.html">mocoolka-tools-string</a><ul class='methods'><li data-type='method'><a href="module-mocoolka-tools-string.html#~format">format</a></li><li data-type='method'><a href="module-mocoolka-tools-string.html#~md5">md5</a></li><li data-type='method'><a href="module-mocoolka-tools-string.html#~md5Cache">md5Cache</a></li></ul></li><li><a href="module-mocoolka-tools-validation.html">mocoolka-tools-validation</a><ul class='methods'><li data-type='method'><a href="module-mocoolka-tools-validation.html#~blank">blank</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#getLogFunction">getLogFunction</a></li><li><a href="global.html#typeDetect">typeDetect</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">lib/i18n-tools.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** @module mocoolka-tools-i18n */
import {
  loggerTools, fileTools, globalTools, errorTools, objectTools,
  envTools, cldrTools, stringTools, osTools ,moduleTools
}
  from '../index.js';
import Globalize from 'globalize';

const ENGLISH = 'en';
const DEFAULT_DATETIME = {datetime: 'medium'};
const DEFAULT_PLURAL = {type: 'ordinal'};
const DEFAULT_RELATIVE = {};
const DEFAULT_UNIT = {form: 'short'};
const DEFAULT_NUMBER = {round: 'floor'};
const DEFAULT_CURRENCY = {style: 'name'};

let i18nConfig = {
  ENGLISH: 'en',
  DEFAULT_DATETIME: {datetime: 'medium'},
  DEFAULT_PLURAL: {type: 'ordinal'},
  DEFAULT_RELATIVE: {},
  DEFAULT_UNIT: {form: 'short'},
  DEFAULT_NUMBER: {round: 'floor'},
  DEFAULT_CURRENCY: {style: 'name'},
  LANGUAGE: 'en',
  SUPPORTS_LANGUAGES: [
	'en', // English
	'zh-Hans', // Chinese (Simplified)
	/*'de', // German
	'es', // Spanish
	'fr', // French
	'it', // Italian
	'pt', // Portuguese
	'ru', // Russian
	'ja', // Japanese
	'ko', // Korean
	'zh-Hant', // Chinese (traditional)
	'ar', // Arabic
	'bn', // Bengali, Bangla
	'cs', // Czech
	'el', // Greek
	'fi', // Finnish
	'hi', // Hindi
	'id', // Indonesian
	'lt', // Lithuanian
	'nb', // Norwegian Bokmål
	'nl', // Dutch
	'pl', // Polish
	'ro', // Romanian
	'sl', // Slovene
	'sv', // Swedish
	'ta', // Tamil
	'te', // Telugu
	'th', // Thai
	'tr', // Turkish
	'uk', // Ukrainian
	'vi', // Vietnamese
	'af', // Afrikaans
	'am', // Amharic
	'az', // Azerbaijani
	'be', // Belarusian
	'bg', // Bulgarian
	'bs', // Bosnian
	'ca', // Catalan
	'cy', // Welsh
	'da', // Danish
	'et', // Estonian
	'eu', // Basque
	'fa', // Persian
	'fil', // Philippino
	'fo', // Faroese
	'ga', // Irish
	'gl', // Galician
	'gu', // Gujarati
	'he', // Hebrew
	'hr', // Croatian
	'hu', // Hungarian
	'hy', // Armenian
	'is', // Icelandic
	'ka', // Georgian
	'kk', // Kazakh
	'km', // Khmer
	'kn', // Kannada
	'ky', // Kyrgyz
	'lo', // Lao
	'lv', // Latvian
	'mk', // Macedonian
	'ml', // Malayalam
	'mn', // Mongolian
	'mr', // Marathi (Marāṭhī)
	'ms', // Malay
	'my', // Burmese
	'ne', // Nepali
	'pa', // Panjabi, Punjabi
	'si', // Sinhalese, Sinhala
	'sk', // Slovak
	'sq', // Albanian
	'sr', // Serbian
	'sw', // Swahili
	'to', // Tonga (Tonga Islands)
	'ur', // Urdu
	'uz', // Uzbek
	'zu', // Zulu*/
  ],
};

const getConfig = ()=>(
  i18nConfig
);

const setConfig = (config)=> {
  objectTools.merge(i18nConfig, config);
};
/**
 * init i18n
 * @param {string} [lang] - Language ID.
 *     It tries to use App language OS language, then falls back to 'en'
 * @param {string} [dir] - root path
 *     It tries process path
 */
const initI18N = (lang, dir)=> {
  let dirs = getModuleDirectory(dir);
  lang = cldrTools.getSupportedLanguage(lang, dirs.cldr) ||
	cldrTools.getSupportedLanguage(envTools.appLanguage(), dirs.cldr) ||
	cldrTools.getSupportedLanguage(osTools.getOSLanguage(), dirs.cldr) || ENGLISH;
  loadI18N(lang, dirs);
  let GI18N = globalTools.getGI18N();
  if (lang !== ENGLISH) {
	loadI18N(ENGLISH, dirs);
  }

  GI18N.locale(lang);
  GI18N.DEFAULT_LANG = lang;
  return lang;
};

const setLanguage = (lang)=> {
  lang = getLanguage(lang);
  let GI18N = getGI18N();
  GI18N.locale(lang);
  GI18N.DEFAULT_LANG = lang;
};

const getLanguage = (lang)=> (
  cldrTools.getSupportedLanguage(lang) || getGI18N().DEFAULT_LANG
);

const loadI18N = (lang, dirs, enumerateNodeModules)=> {
  let GI18N = globalTools.getGI18N();
  if (!dirs) {
	if (GI18N) {
	  dirs = GI18N.dirs;
	} else {
	  dirs = getModuleDirectory();
	}
  }

  errorTools.languageNotSupport(lang);
  if (!GI18N) {
	let versionSG = moduleTools.getModuleVersion(dirs.root);
	let versionG = moduleTools.getModuleVersion(
	  fileTools.path(dirs.root, 'node_modules', 'globalize'));
	globalTools.setGlobal('MocoolkaI18N', {
	  versionSG: versionSG,
	  versionG: versionG,
	  bundles: {},
	  formats: new Map(),
	  getHash: stringTools.md5Cache,
	  load: Globalize.load,
	  locale: Globalize.locale,
	  loadMessages: Globalize.loadMessages,
	  DEFAULT_LANG: ENGLISH,
	  LOG_FN: null,
	  DISABLE_CONSOLE: false,
	  MASTER_ROOT_DIR: dirs.root,
	  MSG_RES_LOADED: [],
	  dirs: dirs,
	});
	loadCldr(ENGLISH);
	GI18N = globalTools.getGI18N();
	GI18N.bundles[ENGLISH] =
	  new Globalize(ENGLISH);
	GI18N.locale(ENGLISH);
	loadMessageFromFile(dirs.intl, enumerateNodeModules);
	let log = loggerTools.getLogFunction(dirs.log);
	setPersistentLogging(log, false);
  }

  if (!(lang in GI18N.bundles)) {
	loadCldr(lang);
	GI18N.bundles[lang] = new Globalize(lang);
	GI18N.locale(lang);
  }

  return GI18N.bundles[lang];
};

/**
 * load message in path
 * @param {string} rootDir
 * @param {boolean}enumerateNodeModules - if value equal true then load node_modules
 */
const loadMessageFromFile = (rootDir, enumerateNodeModules)=> {
  let GI18N = getGI18N();

  enumerateNodeModules = enumerateNodeModules || false;
  enumerateMsgSync(rootDir, enumerateNodeModules,
	function(jsonObj) {
	  GI18N.loadMessages(JSON.parse(jsonObj));
	});
};

/**
 * load cldr with language
 * @param {string}lang
 */
const loadCldr = (lang)=> {
  let GI18N = getGI18N();
  moduleTools.enumerateFilesSync(GI18N.dirs.cldr, null, ['json'], false,
	function(content, filePath) {
	  let cldr = null;
	  try {
		cldr = JSON.parse(content);
	  } catch (e) {
		errorTools.throwError('i18n.parseCLDR', {path: filePath});
	  }

	  let cldrMain = {main: {}};
	  cldrMain.main[lang] = cldr.main[lang];
	  GI18N.load(cldrMain);
	  if (lang === ENGLISH) {
		let cldrSupplemental = {supplemental: cldr.supplemental};
		GI18N.load(cldrSupplemental);
	  }
	});
};

/**
 * return is message output in console
 * @return {boolean}
 */
const consoleEnabled = ()=> {
  let GI18N = getGI18N();
  return !GI18N.DISABLE_CONSOLE;
};

const setPersistentLogging = (logFn, disableConsole)=> {
  errorTools.paramRequired(logFn, {variableName: 'logFn'});
  errorTools.type(logFn, 'function', {variableName: 'logFn'});

  let GI18N = getGI18N();
  GI18N.DISABLE_CONSOLE = !!disableConsole;
  try {
	let message = 'Mocoolka Globalize persistent logging started at '
	  + (new Date()).toString();
	logFn('info', {
	  language: ENGLISH,
	  message: message,
	  orig: message,
	  vars: [],
	});
	GI18N.LOG_FN = logFn;
  } catch (e) {
	GI18N.LOG_FN = null;
  }
};

/**
 * log persistent
 * @param {string}level
 * @param {Object}message
 */
const logPersistent = (level, message)=> {
  let GI18N = getGI18N();
  if (!GI18N.LOG_FN) return;
  level = level || 'info';
  if (typeof GI18N.LOG_FN === 'function') {
	GI18N.LOG_FN(level, message);
  }

};

const packMessage = (messageKey, messageValue, fn, withOriginalMsg, lang)=> {
  let GI18N = getGI18N();
  lang = lang || GI18N.DEFAULT_LANG;
  let message = formatMessage(messageKey, messageValue, lang);
  let englishMessage = message;
  if (lang !== ENGLISH) {
	englishMessage = formatMessage(messageKey, messageValue, ENGLISH);
  }

  if (withOriginalMsg) message = {
	language: lang,
	message: message,
	englishMessage: englishMessage,
	messageKey: messageKey,
	messageValue: messageValue,
  };
  if (fn) return fn(message);
  return message;
};

/* RFC 5424 Syslog Message Severities
 * 0 Emergency: system is unusable
 * 1 Alert: action must be taken immediately
 * 2 Critical: critical conditions
 * 3 Error: error conditions
 * 4 Warning: warning conditions
 * 5 Notice: normal but significant condition
 * 6 Informational: informational messages
 * 7 Debug: debug-level messages
 */

const rfc5424 = (level, messageKey, messageValue, console, lang)=> (
  packMessage(messageKey, messageValue, function(msg) {
	logPersistent(level, msg);
	if (consoleEnabled()) {
	  console(msg.message);
	}
  }, true, lang)
);

const formatMessage = (value, options, lang) => {
  errorTools.paramRequired(value, 'value');
  let GI18N = getGI18N();
  lang = lang || GI18N.DEFAULT_LANG;
  let G = GI18N.bundles[lang];
  let msg = null;
  try {

	msg = G.formatMessage(value, options);
  } catch (e) {
	console.error(e.message);
	//console.error(e.code === 'E_MISSING_MESSAGE');
	error('i18n/E-FORMAT',
	  {type: 'Message', value: value, options: options, language: lang});
	// throw new Error(errorTools.getErrorMessage());
	errorTools.throwError('i18n/E-FORMAT',
	  {type: 'Message', value: value, options: options, language: lang});
  }

  return msg;
};

/**
 * Globalize.formatNumber wrapper returns a string.
 *
 * @param {value} integer or float
 * @param {Object} The options (optional); if null, use the StrongLoop default.
 *     Strongly recommended to set NO options and let strong-globalize use
 *     the StrongLoop default for consistency across StrongLoop products.
 *     See https://www.npmjs.com/package/globalize#number-module
 * @param {string} [lang]
 */
const formatNumber = (value, options, lang) => {
  errorTools.paramRequired(value, 'value');
  let GI18N = getGI18N();
  lang = lang || GI18N.DEFAULT_LANG;
  options = options || DEFAULT_NUMBER;
  let G = GI18N.bundles[lang];
  let msg = null;
  try {
	msg = G.formatNumber(value, options);
  } catch (e) {
	errorTools.throwError('i18n.formatError',
	  {type: 'Number', value: value, options: options, language: lang});
  }

  return msg;
};

/**
 * Globalize.formatDate wrapper returns a string.
 *
 * @param {Object} such as new Date()
 * @param {Object} The options (optional); if null, use the StrongLoop default.
 *     Strongly recommended to set NO options and let strong-globalize use
 *     the StrongLoop default for consistency across StrongLoop products.
 *     See https://www.npmjs.com/package/globalize#date-module
 * @param {string} [lang]
 */
const formatDate = (value, options, lang)=> {
  errorTools.paramRequired(value, 'value');
  let GI18N = getGI18N();
  lang = lang || GI18N.DEFAULT_LANG;
  options = options || DEFAULT_DATETIME;
  let G = GI18N.bundles[lang];
  let msg = null;
  try {
	msg = G.formatDate(value, options);
  } catch (e) {
	errorTools.throwError('i18n.formatError',
	  {type: 'Date', value: value, options: options, language: lang});
  }

  return msg;
};

const plural = (value, options, lang)=> {
  errorTools.paramRequired(value, 'value');
  let GI18N = getGI18N();
  lang = lang || GI18N.DEFAULT_LANG;
  options = options || DEFAULT_PLURAL;
  let G = GI18N.bundles[lang];
  let msg = null;
  try {
	msg = G.plural(value, options);
  } catch (e) {
	errorTools.throwError('i18n.formatError',
	  {type: 'plural', value: value, options: options, language: lang});
  }

  return msg;
};

const formatRelativeTime = (value, unit, options, lang)=> {
  errorTools.paramRequired(value, 'value');
  let GI18N = getGI18N();
  lang = lang || GI18N.DEFAULT_LANG;
  options = options || DEFAULT_RELATIVE;
  let G = GI18N.bundles[lang];
  let msg = null;
  try {
	msg = G.formatRelativeTime(value, unit, options);
  } catch (e) {
	errorTools.throwError('i18n.formatError',
	  {type: 'RelativeTime', value: value, options: options, language: lang});
  }

  return msg;
};

const formatUnit = (value, unit, options, lang)=> {
  errorTools.paramRequired(value, 'value');
  errorTools.paramRequired(unit, 'unit');
  let GI18N = getGI18N();
  lang = lang || GI18N.DEFAULT_LANG;
  options = options || DEFAULT_UNIT;
  let G = GI18N.bundles[lang];
  let msg = null;
  try {
	msg = G.formatUnit(value, unit, options);
  } catch (e) {

	errorTools.throwError('i18n.formatUnit',
	  {value: value, unit: unit, options: options, language: lang});
  }

  return msg;
};

/**
 * Globalize.formatCurrency wrapper returns a string.
 *
 * @param {value} integer or float
 * @param {string} three-letter currency symbol, ISO 4217 Currency Code
 * @param {Object} The options (optional); if null, use the StrongLoop default.
 *     Strongly recommended to set NO options and let strong-globalize use
 *     the StrongLoop default for consistency across StrongLoop products.
 *     See https://www.npmjs.com/package/globalize#curency-module
 * @param {string} [lang]
 */
const formatCurrency = (value, currencySymbol, options, lang)=> {
  errorTools.paramRequired(value, 'value');
  errorTools.paramRequired(currencySymbol, 'currencySymbol');
  let GI18N = getGI18N();
  lang = lang || GI18N.DEFAULT_LANG;
  options = options || DEFAULT_CURRENCY;
  let G = GI18N.bundles[lang];
  let msg = null;
  try {
	msg = G.formatCurrency(value, currencySymbol, options);
  } catch (e) {
	errorTools.throwError('i18n.formatCurrencyError',
	  {currencySymbol: currencySymbol, value: value, options: options, language: lang});
  }

  return msg;
};

const emergency = (messageKey, messageValue, lang)=> (
  rfc5424('emerg', messageKey, messageValue, console.error, lang)
);

const alert = (messageKey, messageValue, lang)=> (
  rfc5424('alert', messageKey, messageValue, console.error, lang)
);

const critical = (messageKey, messageValue, lang)=> (
  rfc5424('crit', messageKey, messageValue, console.error, lang)
);

const error = (messageKey, messageValue, lang)=> (
  rfc5424('error', messageKey, messageValue, console.error, lang)
);

const errorAndThrow = (messageKey, messageValue, lang)=> (
  rfc5424('error', messageKey, messageValue, console.error, lang)
);

const warning = (messageKey, messageValue, lang)=> (
  rfc5424('warning', messageKey, messageValue, console.error, lang)
);

const notice = (messageKey, messageValue, lang)=> (
  rfc5424('notice', messageKey, messageValue, console.log, lang)
);

const information = (messageKey, messageValue, lang)=> (
  rfc5424('info', messageKey, messageValue, console.log, lang)
);

const debug = (messageKey, messageValue, lang)=> (
  rfc5424('debug', messageKey, messageValue, console.log, lang)
);

// Node.js console
const warn = (messageKey, messageValue, lang)=> (
  rfc5424('warn', messageKey, messageValue, console.error, lang)
);

const info = (messageKey, messageValue, lang)=> (
  rfc5424('info', messageKey, messageValue, console.log, lang)
);

const log = (messageKey, messageValue, lang)=> (
  rfc5424('log', messageKey, messageValue, console.log, lang)
);

// Misc Logging Levels
const help = (messageKey, messageValue, lang)=> (
  rfc5424('help', messageKey, messageValue, console.log, lang)
);

const data = (messageKey, messageValue, lang)=> (
  rfc5424('data', messageKey, messageValue, console.log, lang)
);

const prompt = (messageKey, messageValue, lang)=> (
  rfc5424('prompt', messageKey, messageValue, console.log, lang)
);

const verbose = (messageKey, messageValue, lang)=> (
  rfc5424('verbose', messageKey, messageValue, console.log, lang)
);

const input = (messageKey, messageValue, lang)=> (
  rfc5424('input', messageKey, messageValue, console.log, lang)
);

const silly = (messageKey, messageValue, lang)=> (
  rfc5424('silly', messageKey, messageValue, console.log, lang)
);
/**
 * check if GI18N be created,if not then create GI18N,return GI18N
 */
const getGI18N = ()=> {
  let GI18N = globalTools.getGI18N();
  if (!GI18N) {
	initI18N();
	GI18N = globalTools.getGI18N();
  }

  return GI18N;
};

/**
 * get module directory
 * @param {string} [rootPath]
 * @return {}
 */
const getModuleDirectory = (rootPath)=> {
  rootPath = rootPath || fileTools.getCurrentDir();

  errorTools.directoryNotExist(rootPath);
  errorTools.directoryNotExist(fileTools.path(rootPath, 'intl'));
  errorTools.directoryNotExist(fileTools.path(__dirname, '..', '..', 'cldr'));

  return {
	root: rootPath,
	intl: fileTools.path(rootPath, 'intl'),
	cldr: fileTools.path(__dirname, '..', '..', 'cldr'),
	log: fileTools.path(rootPath, 'logs'),
  };
};

const getCldrDirectory = ()=> (
  fileTools.path(__dirname, '..', '..', 'cldr')
);
/**
 * enumerate message sync
 * @param {string}rootDir
 * @param {boolean}checkNodeModules
 * @param {Function}callback
 */
const enumerateMsgSync = (rootDir, checkNodeModules, callback)=> {
  moduleTools.enumerateFilesSync(rootDir, [], ['json'], checkNodeModules, callback);
};

/**
 * Supported languages in CLDR notation
 */
const I18nTools = {
  ENGLISH,
  getCldrDirectory,
  getGI18N,
  initI18N,
  setLanguage,
  loadMessageFromFile,
  formatMessage,
  formatNumber,
  formatDate,
  plural,
  formatRelativeTime,
  formatUnit,
  formatCurrency,
  emergency,
  alert,
  critical,
  error,
  warning,
  notice,
  information,
  debug,
  warn,
  info,
  log,
  help,
  data,
  prompt,
  verbose,
  input,
  silly,
};

export default I18nTools;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Thu Apr 06 2017 18:35:02 GMT+0800 (中国标准时间) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
